<!--
SPDX-FileCopyrightText: 2025-present Tobias Kunze
SPDX-License-Identifier: AGPL-3.0-only WITH LicenseRef-Pretalx-AGPL-3.0-Terms
-->

{% extends "orga/base.html" %}

{% load i18n %}
{% load static %}

{% block extra_title %}{% translate "Activity Log Detail" %} :: {% endblock extra_title %}

{% block stylesheets %}
    <link rel="stylesheet" href="{% static "orga/css/ui/history.css" %}">
{% endblock stylesheets %}

{% block content %}
        <h2>{% translate "Log Detail" %}</h2>
        <div class="log-meta">
            <div class="log-meta-item">
                <i class="fa fa-clock-o"></i>
                <span>{{ log.timestamp|date:"DATETIME_FORMAT" }}</span>
            </div>
            {% if log.person %}
                <div class="log-meta-item">
                    {% if log.is_orga_action %}
                        <i class="fa fa-check-circle fa-fw text-success" title="{% translate 'This change was performed by an event organiser.' %}"></i>
                    {% else %}
                        <i class="fa fa-user fa-fw"></i>
                    {% endif %}
                    {% include "orga/includes/user_name.html" with user=log.person lightbox=True %}
                </div>
            {% endif %}
            <div class="log-meta-item">
                <i class="fa fa-flag"></i>
                <span>{{ log.display }}</span>
            </div>
            {% if log.display_object %}
                <div class="log-meta-item">
                    <span>{{ log.display_object|safe }}</span>
                </div>
            {% endif %}
        </div>
    </div>

    <div class="changes-container">
        {% if log.changes %}
            <h3>{% translate "Changes" %}</h3>
            <table>
                <thead>
                    <tr>
                        <th></th>
                        <th>{% translate "Before" %}</th>
                        <th>{% translate "After" %}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for field, change in log.changes.items %}
                        <tr>
                            <td>
                                {% if change.question %}<a href="{{ question.orga_urls.base }}">{% endif %}
                                {{ change.label|default:field }}
                                {% if change.question %}</a>{% endif %}
                            </td>
                            <td>
                                {% if change.old %}
                                    {{ change.old|default:"–" }}
                                {% endif %}
                            </td>
                            <td>
                                {% if change.new %}
                                    {{ change.new|default:"–" }}
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endif %}
{% endblock content %}
