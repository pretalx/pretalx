{% extends "agenda/base.html" %}
{% load compress %}
{% load i18n %}
{% load rich_text %}
{% load staticfiles %}

{% block agenda_custom_header %}
<meta name="twitter:card" content="summary" />
<meta property="og:title" content="{{ talk.title }}" />
<meta property="og:description" content="{{ talk.description|default:talk.abstract|default:"" }}" />
{% endblock %}

{% block content %}

    <h3 class="talk-title">
        »{{ talk.title }}«
        {% if request.user in talk.speakers.all %}
            <a href="{{ talk.urls.user_base }}"
                    class="btn btn-sm btn-secondary">
                <span class="fa fa-pencil"></span>{% trans "Edit" %}
            </a>
        {% endif %}
        {% if talk.does_accept_feedback %}
            <a href="{{ talk.urls.feedback }}"
                    class="btn btn-sm btn-primary">
                <span class="fa fa-comments"></span>{% trans "Feedback" %}
            </a>
        {% endif %}
        <small>
            {{ talk.slot.start.date|date:"c" }}, {{ talk.slot.start|date:"H:i" }}–{{ talk.slot.end|date:"H:i" }}, {{ talk.slot.room.name }}
        </small>
    </h3>
    <div class="talk row">
        <div class="talk-content col-lg-8 col-md-6 col-xs-12">
            {% if talk.do_not_record %}
                <em>{% trans "This talk will not be recorded." %}</em>
            {% endif %}
            {% if talk.recording_url %}
                {{ talk.rendered_recording_iframe|safe }}
            {% endif %}
            <div class="description">
                {{ talk.description|rich_text }}
            </div>
            <div class="abstact">
                {{ talk.abstract|rich_text }}
            </div>
        </div>
        <div class="col-lg-4 col-md-6 col-xs-12">
            {% if speakers|length %}
            <div class="speakers">
                <div class="speaker-header">
                    {% if speakers.1 %}
                        {% trans "Speakers" %}
                    {% elif speakers.0 %}
                        {% trans "Speaker" %}
                    {% endif %}
                </div>
                {% for speaker in speakers %}
                    <div class="speaker">
                        <div class="name">{{ speaker.get_display_name }}</div>
                        <div class="info">
                            {% if speaker.talk_profile.biography %}
                            <p class="biography">{{ speaker.talk_profile.biography|rich_text }}</p>
                            {% endif %}

                            {% if speaker.other_talks.count > 1 %}
                                {% trans 'Other talks by this speaker:' %}
                                <ul class="speaker-talks">
                                    {% for talk in speaker.other_talks %}
                                    <li class="speaker-talk">
                                        <a href='{{ talk.submission.urls.public }}'>{{ talk.submission.title }}</a>
                                    </li>
                                    {% endfor %}
                                </ul>
                            {% elif speaker.other_talks.count == 1 %}
                                <span class="speaker-talk">
                                    {% trans 'This speaker also holds' %}
                                    "<a href='{{ speaker.other_talks.0.submission.urls.public }}'>{{ speaker.other_talks.0.submission.title }}</a>".
                                </span>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </div>
{% endblock %}
